# 3.3.2 Clases y objetos (II): herencia y encapsulación

En la programación orientada a objetos, **herencia** y **encapsulación** son dos conceptos clave que permiten crear código más organizado, reutilizable y seguro.
En JavaScript se implementan a través de las clases, sus constructores y los modificadores de acceso.

---

## 📌 Herencia

La **herencia** permite que una clase (*subclase*) extienda otra clase (*superclase*), heredando sus propiedades y métodos.
Esto evita repetir código y facilita la especialización de clases.

### Sintaxis básica con `extends`

```js
// Clase base
class Animal {
  constructor(nombre) {
    this.nombre = nombre;
  }

  hablar() {
    console.log(`${this.nombre} hace un sonido.`);
  }
}

// Subclase que hereda de Animal
class Perro extends Animal {
  hablar() {
    console.log(`${this.nombre} ladra: ¡guau guau!`);
  }
}

const perro = new Perro("Toby");
perro.hablar(); // Toby ladra: ¡guau guau!
```

En este ejemplo, `Perro` hereda de `Animal` y sobrescribe (`override`) el método `hablar`.

### Uso de `super`

La palabra clave `super` permite **llamar al constructor o métodos de la clase padre**.

```js
class Gato extends Animal {
  constructor(nombre, color) {
    super(nombre); // Llama al constructor de Animal
    this.color = color;
  }

  hablar() {
    super.hablar(); // Llama al método de la superclase
    console.log(`${this.nombre} maúlla: ¡miau!`);
  }
}

const gato = new Gato("Michi", "negro");
gato.hablar();
// Michi hace un sonido.
// Michi maúlla: ¡miau!
```

---

## 📌 Encapsulación

La **encapsulación** significa proteger el acceso a los datos internos de un objeto, para que solo se manipulen a través de métodos seguros.

En JavaScript moderno se usa el prefijo `#` para declarar **propiedades privadas** dentro de una clase.

```js
class CuentaBancaria {
  #saldo; // Propiedad privada

  constructor(saldoInicial) {
    this.#saldo = saldoInicial;
  }

  // Método público para consultar
  verSaldo() {
    return this.#saldo;
  }

  // Método público para modificar con seguridad
  depositar(cantidad) {
    if (cantidad > 0) {
      this.#saldo += cantidad;
    }
  }

  retirar(cantidad) {
    if (cantidad > 0 && cantidad <= this.#saldo) {
      this.#saldo -= cantidad;
    } else {
      console.log("Fondos insuficientes o cantidad inválida.");
    }
  }
}

const cuenta = new CuentaBancaria(100);
console.log(cuenta.verSaldo()); // 100
cuenta.depositar(50);
console.log(cuenta.verSaldo()); // 150
cuenta.retirar(200); // Fondos insuficientes
```

!!! note "Propiedades privadas modernas"
    Antes de la introducción del prefijo `#` (ES2022), se usaban convenciones como `_saldo` para indicar que una propiedad debía tratarse como privada, pero no había protección real.
    Hoy en día, `#` garantiza que la propiedad no pueda accederse desde fuera de la clase.

---

## 📝 Preguntas de repaso

!!! question "Reflexiona sobre lo aprendido"
    1. ¿Qué palabra clave se utiliza para extender una clase en JavaScript?
    2. ¿Qué función tiene `super` dentro de una subclase?
    3. ¿Qué diferencia hay entre usar `_propiedad` y `#propiedad` en una clase?
    4. Escribe una clase `Empleado` que herede de `Persona` y añada la propiedad `salario`.
    5. ¿Cómo se consigue proteger los datos internos de una clase en JavaScript?